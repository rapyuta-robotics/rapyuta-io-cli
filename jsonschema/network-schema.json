{
  "$schema": "https://json-schema.org/draft-07/schema",
  "title": "Network",
  "$ref": "#/definitions/network",
  "definitions": {
    "network": {
      "type": "object",
      "properties": {
        "apiVersion": {
          "const": "apiextensions.rapyuta.io/v1"
        },
        "kind": {
          "const": "Network"
        },
        "metadata": {
          "$ref": "#/definitions/metadata"
        },
        "spec": {
          "$ref": "#/definitions/networkSpec"
        }
      },
      "required": [
        "apiVersion",
        "kind",
        "metadata",
        "spec"
      ]
    },
    "networkSpec": {
      "type": "object",
      "properties": {
        "runtime": {
          "$ref": "#/definitions/runtime"
        },
        "type": {
          "$ref": "#/definitions/networkType"
        },
        "rosDistro": {
          "$ref": "#/definitions/rosDistro"
        }
      },
      "required": [
        "runtime",
        "type",
        "rosDistro"
      ],
      "allOf": [
        {
          "if": {
            "properties": {
              "runtime": {
                "const": "Cloud"
              }
            }
          },
          "then": {
            "properties": {
              "resourceLimits": {
                "$ref": "#/definitions/resourceLimits"
              }
            },
            "required": [
              "resourceLimits"
            ]
          }
        },
        {
          "if": {
            "properties": {
              "runtime": {
                "const": "Device"
              }
            }
          },
          "then": {
            "properties": {
              "deviceGUID": {
                "$ref": "#/definitions/uuid"
              },
              "networkInterface": {
                "type": "string"
              }
            },
            "required": [
              "deviceGUID",
              "networkInterface"
            ]
          }
        }
      ]
    },
    "resourceLimits": {
      "enum": [
        "XSmall",
        "Small",
        "Medium",
        "Large"
      ]
    },
    "rosDistro": {
      "enum": [
        "melodic",
        "kinetic",
        "noetic"
      ]
    },
    "restartPolicy": {
      "enum": [
        "Always",
        "Never",
        "OnFailure"
      ]
    },
    "runtime": {
      "enum": [
        "Cloud",
        "Device"
      ]
    },
    "networkType": {
      "enum": [
        "Routed",
        "Native"
      ]
    },
    "metadata": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "guid": {
          "$ref": "#/definitions/networkGUID"
        },
        "creator": {
          "$ref": "#/definitions/uuid"
        },
        "project": {
          "$ref": "#/definitions/projectGUID"
        },
        "labels": {
          "$ref": "#/definitions/stringMap",
          "uniqueItems": true
        }
      },
      "required": [
        "name"
      ]
    },
    "networkGUID": {
      "type": "string",
      "pattern": "^network-[a-z]{24}$"
    },
    "projectGUID": {
      "type": "string",
      "pattern": "^project-[a-z]{24}$"
    },
    "stringMap": {
      "type": "object",
      "additionalProperties": {
        "type": "string"
      }
    },
    "uuid": {
      "type": "string",
      "pattern": "^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"
    }
  }
}
